<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบสอบถามความพึงพอใจ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
        }
        .survey-container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .question-group {
            margin-bottom: 25px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        .question-group:last-child {
            border-bottom: none;
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .radio-options label {
            display: inline-block;
            margin-right: 20px;
            font-weight: normal;
        }
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            min-height: 100px;
            box-sizing: border-box;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

    <div class="survey-container">
        <h2>แบบสอบถามความพึงพอใจโครงการ</h2>
        
        <form action="https://docs.google.com/forms/d/e/1FAIpQLSfiHlQu_-ZBFTG0k8Rq5ge32bgQ1I_on3X8rKj02UopV7Oa9Q/formResponse" method="POST" id="googleForm">
            <div class="question-group">
                <!-- get data parameter  -->
                <input type="hidden" name="entry.1041271350" id="project_no_get">
                <input type="hidden" name="entry.1138050306" id="round_get">
                <input type="hidden" name="entry.39006750" id="survey_type_get">
                <input type="hidden" name="entry.1684685543" id="employee_email_get">
            </div>
            <div class="question-group">
                <p><strong>Q1) Overall quality of product & service</strong></p>
                <div class="radio-options">
                    <label><input type="radio" name="entry.3997204" value="1" required> 1. Very Satisfied</label>
                    <label><input type="radio" name="entry.3997204" value="2"> 2. Satisfied</label>
                    <label><input type="radio" name="entry.3997204" value="3"> 3. Neither satisfied</label>
                    <label><input type="radio" name="entry.3997204" value="4"> 4. Dissatisfied</label>
                    <label><input type="radio" name="entry.3997204" value="5"> 5. Very dissatisfied</label>
                </div>
            </div>
            
            <div class="question-group">
                <p><strong>Q2) Client service team</strong></p>
                <div class="radio-options">
                    <label><input type="radio" name="entry.77707608" value="1" required> 1. Very Satisfied</label>
                    <label><input type="radio" name="entry.77707608" value="2"> 2. Satisfied</label>
                    <label><input type="radio" name="entry.77707608" value="3"> 3. Neither satisfied</label>
                    <label><input type="radio" name="entry.77707608" value="4"> 4. Dissatisfied</label>
                    <label><input type="radio" name="entry.77707608" value="5"> 5. Very dissatisfied</label>
                </div>
            </div>

            <div class="question-group">
                <p><strong>Q3) Timeliness - no unreasonable delay</strong></p>
                <div class="radio-options">
                    <label><input type="radio" name="entry.1355562660" value="1" required> 1. Very Satisfied</label>
                    <label><input type="radio" name="entry.1355562660" value="2"> 2. Satisfied</label>
                    <label><input type="radio" name="entry.1355562660" value="3"> 3. Neither satisfied</label>
                    <label><input type="radio" name="entry.1355562660" value="4"> 4. Dissatisfied</label>
                    <label><input type="radio" name="entry.1355562660" value="5"> 5. Very dissatisfied</label>
                </div>
            </div>
            
            <div class="question-group">
                <p><strong>Q4) Accuracy of data file</strong></p>
                <div class="radio-options">
                    <label><input type="radio" name="entry.1430791495" value="1" required> 1. Very Satisfied</label>
                    <label><input type="radio" name="entry.1430791495" value="2"> 2. Satisfied</label>
                    <label><input type="radio" name="entry.1430791495" value="3"> 3. Neither satisfied</label>
                    <label><input type="radio" name="entry.1430791495" value="4"> 4. Dissatisfied</label>
                    <label><input type="radio" name="entry.1430791495" value="5"> 5. Very dissatisfied</label>
                </div>
            </div>

            <div class="question-group">
                <p><strong>Q5) Actionable results</strong></p>
                <div class="radio-options">
                    <label><input type="radio" name="entry.228333784" value="1" required> 1. Very Satisfied</label>
                    <label><input type="radio" name="entry.228333784" value="2"> 2. Satisfied</label>
                    <label><input type="radio" name="entry.228333784" value="3"> 3. Neither satisfied</label>
                    <label><input type="radio" name="entry.228333784" value="4"> 4. Dissatisfied</label>
                    <label><input type="radio" name="entry.228333784" value="5"> 5. Very dissatisfied</label>
                </div>
            </div>

            <div class="question-group">
                <p><strong>Q6) Presentation</strong></p>
                <div class="radio-options">
                    <label><input type="radio" name="entry.602056392" value="1" required> 1. Very Satisfied</label>
                    <label><input type="radio" name="entry.602056392" value="2"> 2. Satisfied</label>
                    <label><input type="radio" name="entry.602056392" value="3"> 3. Neither satisfied</label>
                    <label><input type="radio" name="entry.602056392" value="4"> 4. Dissatisfied</label>
                    <label><input type="radio" name="entry.602056392" value="5"> 5. Very dissatisfied</label>
                </div>
            </div>
            
            <div class="question-group">
                <label for="suggestion">Q7) Do you have any other suggestions/comments that would help us make your next projects with us more satisfactory?</label>
                <textarea id="suggestion" name="entry.1515032099" rows="4"></textarea>
            </div>
            
            <button type="submit">ส่งแบบสอบถาม</button>
            
        </form>
        <script>
        // เมื่อหน้าเว็บโหลดเสร็จ
        window.onload = function() {
            // 1. ดึงค่าจาก URL
            const urlParams = new URLSearchParams(window.location.search);
            const projectNo = urlParams.get('project_no');
            const round = urlParams.get('round');
            const surveyType = urlParams.get('survey_type');
            const employeeEmail = urlParams.get('employee_email');

             // ตรวจสอบว่ามี query parameters ที่ต้องใช้ส่งหรือไม่
            if (window.location.search) {

                // 2. กำหนดค่าที่ได้ให้กับช่อง input hidden ในฟอร์ม HTML
                // *** และ ID ของ entry ใน input hidden ให้ตรงกับ Google Form ของคุณ
                if (projectNo) {
                    document.getElementById('project_no_get').value = projectNo;
                }
                if (round) {
                    document.getElementById('round_get').value = round;
                }
                if (surveyType) {
                    document.getElementById('survey_type_get').value = surveyType;
                }
                if (employeeEmail) {
                    document.getElementById('employee_email_get').value = employeeEmail;
                }
                
                if (window.history.replaceState) {
                    // สร้าง URL ใหม่ที่ไม่เหลือ query string (?...)
                    const cleanUrl = window.location.pathname + window.location.hash;
                    
                    // แทนที่ history state ปัจจุบันด้วย URL ที่สะอาด
                    history.replaceState(null, document.title, cleanUrl);
                }
                // ทางเลือก: หากต้องการให้ฟอร์ม submit อัตโนมัติเมื่อโหลดหน้าเสร็จ
                // document.getElementById('googleForm').submit();
            }
             else {
            // กรณีที่เปิดหน้าเว็บโดยไม่มีพารามิเตอร์
            console.log("No parameters found in URL. Form not submitted automatically.");
            }
        };
    </script>
    </div>

</body>
</html>